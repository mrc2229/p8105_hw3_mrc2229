---
title: "p8105_hw3_mrc2229"
author: "Matthew Curran"
date: "October 12, 2019"
output: github_document
---

```{r setup, include=FALSE}
library (tidyverse)
library(viridis)
library (leaflet)
library(knitr)
```

#Problem 1
##Bring in instacart data
```{r}
library(p8105.datasets)
data("instacart")
```
##Examining the instacart data
There are `r nrow (instacart)` observations in the instacart dataset and `r ncol (instacart)` variables in the instacart data set. Some of the key variables are product_name, which shows the product purchased; aisle, which tells us the aisle the purchased item comes from; and order_id, which tells us the id of the person who ordered a certain item. So we can see things like that person with order_id 1 got  `r instacart %>% filter (order_id==1, aisle_id==24) %>% summarise(n_distinct(product_name))` items from aisle 24, the fresh fruit aisle. The instacart dataset also gives information on the time an order was placed. As an example, the person with order_id 1 made their order at the `r instacart %>% filter (order_id==1) %>% summarise(max(order_hour_of_day))`th hour of the day.

##Examining the aisles
There are `r instacart %>% summarise(n_distinct(aisle))` aisles in total and the most items are ordered from the `r instacart %>% count(aisle,name="aisle_count") %>% mutate(aisle_count_rank = rank(desc(aisle_count))) %>% filter (aisle_count_rank == 1 ) %>% summarise(aisle)` and `r instacart %>% count(aisle,name="aisle_count") %>% mutate(aisle_count_rank = rank(desc(aisle_count))) %>% filter (aisle_count_rank == 2 ) %>% summarise(aisle)` aisles.

##Plot of number of items ordered in each aisle
```{r}
items_per_aisle_plot = instacart %>%
  count(aisle,name="aisle_count") %>%
  filter(aisle_count>10000) %>%
  arrange (desc(aisle)) %>%
  ggplot(aes(x=aisle, y=aisle_count)) +
  geom_bar(stat="identity", fill="blue") +
  labs(
    title = "Ammount of Items Purchased in Each Aisle",
    x = "Aisle",
    y ="Ammount of Items Purchased"
  )

items_per_aisle_plot + coord_flip()
```

##Table of most popular items in "baking ingrediant", "dog food care", and "packaged vegatables fruits"
```{r}
most_popular_items = instacart %>%
  select(aisle,product_name) %>%
  filter(
    aisle == "baking ingredients"|
    aisle == "packaged vegetables fruits"|
    aisle == "dog food care"
    ) %>%
  group_by(aisle) %>%
  count(product_name,name="product_count")%>%
  mutate(product_count_rank = rank(desc(product_count))) %>% 
  filter (product_count_rank < 4) %>%
  arrange(aisle, product_count_rank) %>%
  select(aisle, product_count_rank, product_name, product_count) %>%
  kable()
  
most_popular_items
```

##Table showing day and time Pink Lady Apples and Coffee Ice Cream are ordered
```{r}
pink_lady_coffee = instacart %>%
  filter(
  product_name == "Pink Lady Apples"|
  product_name == "Coffee Ice Cream"
  ) %>%
  arrange (product_name, order_dow) %>%
  mutate(
    order_dow = 
    recode(order_dow,
    "0" = "sunday",
    "1" = "monday",
    "2" = "tuesday",
    "3" = "wednesday",
    "4" = "thursday",
    "5" = "friday",
    "6" = "saturday")
    ) %>%
  group_by(product_name,order_dow) %>%
  summarise(mean_hour_of_day=mean(order_hour_of_day)) %>%
  separate(mean_hour_of_day, into = c("hour", "minutes"), sep = 2) %>%
  mutate(minutes = as.numeric(minutes),
         minutes = round(minutes*60, digits = 0))
  
```
